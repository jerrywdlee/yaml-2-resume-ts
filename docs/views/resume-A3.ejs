<html lang="ja">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>履歴書</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.2/html2pdf.bundle.min.js"
      integrity="sha512-MpDFIChbcXl2QgipQrt1VcPHMldRILetapBl5MPCA9Y8r7qvlwx1/Mc9hNTzY+kS5kX6PdoDq41ws1HiVNLdZA=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
      @media print {
        body {
          margin: 0;
          box-shadow: 0;
          page-break-inside: avoid;
        }
      }
      @page {
        size: A3 landscape;
      }
      html {
        font-size: 62.5%;
      }
      body {
        font-size: 10px;
        font-size: 1rem;
        position: relative;
        font-family: sans-serif;
      }
      body {
        background: white;
        display: block;
        margin: 0 auto;
      }
      body[size="A3"][layout="portrait"] {
        /*width: 1220px;
        height: 891px;*/
        /*width: 478px;*/
        /*height: 297mm;*/
        /*96dpi設定*/
        width: 1587px;
        height: 1122px;
        box-sizing: border-box;
      }
      tr {
        height: 32px;
      }
      td {
        padding: 0 5px;
      }

      .image {
        height: 170px;
        width: 162px;
      }
      .image img {
        width:auto;
        height:auto;
        max-width:100%;
        max-height:100%;
      }
      .name {
        font-size: 28px;
      }
      .history {
        padding-left: 20px;
        padding-right: 20px;
      }

      .bd-t-s {
        border-top: 1px solid;
      }
      .bd-r-s {
        border-right: 1px solid;
      }
      .bd-b-s {
        border-bottom: 1px solid;
      }
      .bd-l-s {
        border-left: 1px solid;
      }
      .bd-t-sb {
        border-top: 2px solid;
      }
      .bd-r-sb {
        border-right: 2px solid;
      }
      .bd-b-sb {
        border-bottom: 2px solid;
      }
      .bd-l-sb {
        border-left: 2px solid;
      }
      .bd-t-dt {
        border-top: 1px dotted;
      }
      .bd-r-dt {
        border-right: 1px dotted;
      }
      .bd-b-dt {
        border-bottom: 1px dotted;
      }
      .bd-l-dt {
        border-left: 1px dotted;
      }
      .bd-t-db {
        border-top: 4px double;
      }
      .center {
        text-align: center;
      }
      .left {
        text-align: left;
      }
      .right {
        text-align: right;
      }
    </style>
    <noscript>
      <%= JSON.stringify(conf) %>
    </noscript>
  </head>
  <body size="A3" layout="portrait" style="padding: 51px; box-sizing: border-box">
    <table border-collapse="collapse" cellspacing="0" cellpadding="0" style="table-layout:fixed; width:0">
      <thead>
        <tr style="height: 0px">
          <th style="width:91px"></th>
          <th style="width:60px"></th>
          <th style="width:200px"></th>
          <th style="width:91px"></th>
          <th style="width:91px"></th>
          <th style="width:43mm"></th>
          <th style="width:78px"></th>
          <th style="width:91px"></th>
          <th style="width:60px"></th>
          <th style="width:550px"></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="left" style="font-size:2.4rem; letter-spacing: 2.2rem; font-weight: bold;" colspan="2">履歴書</td>
          <td></td>
          <td class="right" colspan="2">
            <%= yaml.date %> 現在
          </td >
          <% if (yaml.photo) { %>
            <td class="center image" rowspan="5" style="padding: 0 2px 10px 12px;">
              <img style="width: 100%; box-sizing: border-box;" src="<%= yaml.photo %>" alt="写真" />
            </td>
          <% } else { %>
            <td class="center image" rowspan="5" style="padding: 0 15px 20px 25px;">
              <div style="width: 100%; height: 100%; box-sizing: border-box; border: 1px dotted; padding: 10px 10px; font-size: 1.2rem;">
                <p>写真を貼る位置</p>
                <ol style="padding-inline-start: 20px; font-size: 1rem;">
                  <li>縦36〜40 mm<br/>横24〜30 mm</li>
                  <li>本人単身胸以上</li>
                  <li>裏面にのりづけ</li>
                  <li>裏面に氏名記入</li>
                </ol>
              </div>
            </td>
          <% } %>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s ">
          <% if (conf.kana_type.toLowerCase() === 'hiragana') { %>
            ふりがな
          <% } else { %>
            フリガナ
          <% } %>
          </td>
          <td class="bd-t-s bd-r-s" colspan="4">
            <%= yaml.name_kana %>
          </td>
          <td></td>
          <td class="bd-t-s bd-l-s center">年</td>
          <td class="bd-t-s bd-l-dt center">月</td>
          <td class="bd-t-s bd-r-s bd-l-dt center">学歴・職歴</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s" rowspan="2">氏 名</td>
          <td class="bd-t-dt name" colspan="3" rowspan="2">履歴 花子</td>
          <% if (yaml.gender || yaml.sex) { %>
            <td class="bd-t-dt bd-l-dt bd-r-s center" rowspan="2">
              <%= yaml.gender || yaml.sex %>
            </td>
          <% } else { %>
            <td class="bd-t-dt bd-r-s center" rowspan="2"></td>
          <% } %>
          <td></td>
          <td class="bd-t-s bd-l-s   center"></td>
          <td class="bd-t-s bd-l-dt   center"></td>
          <td class="bd-t-s bd-r-s bd-l-dt  history "></td>

        </tr>
        <tr>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">生年月日</td>
          <td class="bd-t-s bd-r-s" colspan="4">
            <%= yaml.birthday %>
            <% if (yaml.age) { %>
              （満<%= yaml.age %>歳）
            <% } %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">携帯電話</td>
          <td class="bd-t-s" colspan="2">
            <%= yaml.mobile || yaml.cell_phone %>
          </td>
          <td class="bd-t-s bd-l-s">E-mail</td>
          <td class="bd-t-s bd-r-s" colspan="2">
            <%= yaml.email || yaml.mail %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">
            <% if (conf.kana_type.toLowerCase() === 'hiragana') { %>
              ふりがな
            <% } else { %>
              フリガナ
            <% } %>
          </td>
          <td class="bd-t-s bd-r-s" colspan="5">
            <%= yaml.address_kana %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">現 住 所</td>
          <td class="bd-t-s " colspan="4">〒 <%= yaml.address_zip %></td>
          <td class="bd-t-s bd-l-s bd-r-s" >電話</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-l-s" style="padding-left: 20px" colspan="5" rowspan="2">
            <%= yaml.address %>
          </td>
          <td class="bd-l-s bd-r-s" style="padding-left: 15px;" rowspan="2">
            <%= yaml.tel %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">
            <% if (conf.kana_type.toLowerCase() === 'hiragana') { %>
              ふりがな
            <% } else { %>
              フリガナ
            <% } %>
          </td>
          <td class="bd-t-s bd-r-s" colspan="5">
            <%= yaml.address_kana2 %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s">連 絡 先</td>
          <td class="bd-t-s " colspan="4">〒 <% yaml.address_zip2 %></td>
          <td class="bd-t-s bd-l-s bd-r-s">電話</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-l-s bd-b-s" style="padding-left: 20px;" colspan="5" rowspan="2">
            <%= yaml.address2 %>
          </td>
          <td class="bd-l-s bd-b-s bd-r-s" style="padding-left: 15px;" rowspan="2">
            <%= yaml.tel2 %>
          </td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td></td>
          <td class="bd-t-dt bd-l-s bd-b-s  center"></td>
          <td class="bd-t-dt bd-l-dt bd-b-s  center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt bd-b-s history "></td>
        </tr>
        <tr style="height: 10px;">
          <td colspan="6"></td>
          <td></td>
          <td colspan="3"></td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s center">年</td>
          <td class="bd-t-s bd-l-dt center">月</td>
          <td class="bd-t-s bd-r-s bd-l-dt center" colspan="4">学歴・職歴</td>
          <td></td>
          <td class="bd-t-s bd-l-s center">年</td>
          <td class="bd-t-s bd-l-dt center">月</td>
          <td class="bd-t-s bd-r-s bd-l-dt center">免許・資格</td>
        </tr>
        <tr>
          <td class="bd-t-s bd-l-s   center"></td>
          <td class="bd-t-s bd-l-dt   center"></td>
          <td class="bd-t-s bd-r-s bd-l-dt  history center" colspan="4" >学歴</td>
          <td></td>
          <td class="bd-t-s bd-l-s   center">2019</td>
          <td class="bd-t-s bd-l-dt   center">8</td>
          <td class="bd-t-s bd-r-s bd-l-dt  history left">履歴書作成コンサルタント　取得</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center">2018</td>
          <td class="bd-t-dt bd-l-dt   center">4</td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history left" colspan="4" >履歴大学　履歴書作成学科　入学</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history right">以上</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center">2022</td>
          <td class="bd-t-dt bd-l-dt   center">3</td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history left" colspan="4" >履歴大学　履歴書作成学科　卒業</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history left" colspan="4" ></td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>

        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history center" colspan="4" >職歴</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>

        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center">2022</td>
          <td class="bd-t-dt bd-l-dt   center">4</td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history left" colspan="4" >総合履歴事務所　入社　</td>
          <td></td>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history "></td>

        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history left" colspan="4" >現在に至る</td>
          <td></td>
          <td class="bd-t-s bd-r-s bd-l-s" colspan="3">志望動機・自己PR</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history right" colspan="4" >以上</td>
          <td></td>
          <td class="bd-t-s bd-r-s bd-l-s" colspan="3" rowspan="4" style="padding: 0 15px;">
            履歴書作成に経験があります。<br />気合は誰にも負けないと思います。<br />どうぞよろしくお願いいたします。
          </td>
        </tr>

        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
          <td class="bd-t-s bd-r-s bd-l-s" colspan="3">本人希望記入欄</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
          <td class="bd-t-s bd-r-s bd-b-s bd-l-s" style="padding: 0 15px;" colspan="3" rowspan="3">御社規定に従います</td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s   center"></td>
          <td class="bd-t-dt bd-l-dt   center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt  history " colspan="4" ></td>
          <td></td>
        </tr>
        <tr>
          <td class="bd-t-dt bd-l-s  bd-b-s center"></td>
          <td class="bd-t-dt bd-l-dt  bd-b-s center"></td>
          <td class="bd-t-dt bd-r-s bd-l-dt bd-b-s history " colspan="4" ></td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <script>
      document.body.scrollTo({
        top: 0,
        left: 0,
        behavior: "instant",
      });
      const opt = {
        filename: '履歴書.pdf',
        image: { type: 'jpeg', quality: 0.99 },
        html2canvas: { scale: 2.4, x: 0, y: 0, useCORS: true },
        jsPDF: { orientation: 'landscape', format: 'a3' }
      };
      html2pdf().set(opt).from(document.body).toPdf().get('pdf').then(pdf => {
        window.open(pdf.output('bloburl'), '_self');
        // window.open(pdf.output('bloburl'), '_blank');
        // location.href = pdf.output('bloburl');
      });
    </script>
  </body>
</html>
